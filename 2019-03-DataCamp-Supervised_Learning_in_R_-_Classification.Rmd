---
title: "Aprendizagem Supervisionada de Classificação em R"
author: "Pedro Almeida"
date: "11 de março de 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1) k-Nearest Neighbors (kNN)

O kNN literalmente aprende pelo exemplo, e é um bom exemplo para começar a entender o aprendizado de máquina supervisionado de classificação. Nessa primeira parte do código apresentarei a aplicação do kNN no reconhecimento de sinais de trânsito de veículos autônomos.

### 1.1) Reconhecimento de sinais de trânsito com kNN

Usarei o dataset signs e o next_sign que possui as observaçoes que irei classificar.

```{r, message=FALSE, warning=FALSE}

# carregando o pacote class
library(class)

# carregando os datasets
signs <- read.csv(file = "signs.csv", sep = ";")
next_sign <- read.csv(file = "next_sign.csv", sep = ";")

# criando o vetor dos rótulos
sign_types <- signs$sign_type

# classificando o próximo sinal observado
knn(train = signs[-1], test = next_sign, cl = sign_types)

```

Explorando o dataset signs

```{r, message=FALSE, warning=FALSE}

# estrutura do signs
str(signs)

# contanto o número de sinais de cada tipo
table(signs$sign_type)

# checando a média da feature r10 (vermelho) por tipo de sinal
aggregate(r10 ~ sign_type, data = signs, mean)

```

Era esperado que os sinais de parada tendem a ter um valor médio de vermelho mais alto. É assim que o kNN identifica sinais semelhantes.

Agora vou fazer previsões com dados não vistos e avaliar a performance do kNN. 

```{r, message=FALSE, warning=FALSE}

# carregando o dataset de teste
signs_test <- read.csv(file = "signs_test.csv", sep = ";")

# usando o kNN para identificar os sinais no dataset de teste
signs_pred <- knn(train = signs[-1], test = signs_test[-1], cl = sign_types)

# matriz de confusão das previsões X os valores atuais
signs_actual <- signs_test$sign_type
table(signs_pred, signs_actual)

# Compute the accuracy
mean(signs_pred == signs_actual)

```

A matriz de confusão permite verificar os erros do modelo classificador.

### 1.2) Testando outros valores de k

A função knn() do pacote class usa apenas o vizinho mais próximo.

Definir o parâmetro k permite que o algoritmo considere vizinhos mais próximos adicionais. Isso amplia a coleção de vizinhos que votarão na classe prevista.

Vou comparar os valores k de 1, 7 e 15 para examinar o impacto na precisão da classificação do sinal de trânsito.

```{r, message=FALSE, warning=FALSE}

# default, k = 1
k_1 <- knn(train = signs[-1], test = signs_test[-1], cl = sign_types)
mean(signs_actual == k_1)

# k = 7
k_7 <- knn(train = signs[-1], test = signs_test[-1], cl = sign_types, k = 7)
mean(signs_actual == k_7)

# k = 15
k_15 <- knn(train = signs[-1], test = signs_test[-1], cl = sign_types, k = 15)
mean(signs_actual == k_15)

```

O modelo configurado com o k igual a 7 possui a melhor acurácia!